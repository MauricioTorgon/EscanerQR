<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Mi QR</title>
  <link rel="stylesheet" href="css/bootstrap.min.css" />
  <link rel="stylesheet" href="css/styles.css" />
  <script src="js/jquery-3.6.0.min.js"></script>
  <script src="js/script.js"></script>
</head>
<body>

  <!-- Header con botón de menú -->
  <header>
    <button id="menu-toggle" class="menu-button">☰</button>
    <h1>Control de Asistencia</h1>
</header>

  <!-- Menú lateral (drawer) -->
  <nav id="sidebar" class="sidebar">
    <img src="img/sidebar/controlAsistencia.png" alt="Torneo de Rubick" class="sideimg">
    <ul>
      <li><a href="bienvenida.html"><img src="img/sidebar/home-icon.png" class="menu-img">Inicio</a></li>
      <li><a href="generarQR.html"><img src="img/sidebar/qr-icon.png" class="menu-img">Mi QR</a></li>
      <li><a href="#" id="logout-link"><img src="img/sidebar/logout-icon.png" alt="Salir" class="menu-img">Salir</a></li>
    </ul>
  </nav>

  <!-- Contenido principal -->
  <main class="main-content">
    <div class="container text-center mt-4">
      <h2 class="mb-3">Tu código QR</h2>
      <canvas id="qr-canvas"></canvas>
      <p id="user-info" class="mt-3 fw-bold"></p>
    </div>
  </main>

<script src="https://cdn.jsdelivr.net/npm/qrious@4.0.2/dist/qrious.min.js"></script>
<script>
  // 1. Obtener usuario actual del localStorage
  const currentUser = JSON.parse(localStorage.getItem('currentUser'));

  if (currentUser) {
    // 2. Mostrar nombre de usuario
    document.getElementById('user-info').textContent = `Username: ${currentUser.username}`;
    
    // 3. Generar el código QR
    const qr = new QRious({
      element: document.getElementById('qr-canvas'), // Dónde se dibuja
      value: currentUser.username,                   // Datos a codificar
      size: 250,                                     // Tamaño en píxeles
    });
  } else {
    // 4. Mensaje si no hay sesión
    document.getElementById('user-info').textContent = "⚠️ No hay sesión iniciada.";
  }
</script>

</body>
</html>
